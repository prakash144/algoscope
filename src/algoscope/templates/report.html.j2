<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>{{ title }}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; color: #222; }
    h1, h2, h3 { margin: 0.6em 0; }
    .grid { display: grid; grid-template-columns: 1fr; gap: 24px; }
    .card { border: 1px solid #eee; border-radius: 12px; padding: 16px; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
    table { width: 100%; border-collapse: collapse; }
    th, td { text-align: left; padding: 8px 10px; border-bottom: 1px solid #eee; }
    .muted { color: #666; }
    .pill { display: inline-block; padding: 2px 8px; border-radius: 12px; background: #f5f5f5; font-size: 12px;}
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
    .two-col { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 16px; }
    @media (max-width: 900px) { .two-col { grid-template-columns: 1fr; } }
    .footer { margin-top: 40px; font-size: 12px; color: #888; }
    .code { background: #fafafa; border: 1px solid #eee; padding: 10px; border-radius: 8px; white-space: pre-wrap; }
  </style>
</head>
<body>
  <h1>{{ title }}</h1>
  {% if notes %}
  <div class="card">{{ notes }}</div>
  {% endif %}

  <div class="grid">
    <div class="card">
      <h2>Manual Big-O Analysis</h2>
      {% for label, md in manual_complexities.items() %}
        <h3>{{ label }}</h3>
        <div class="code">{{ md }}</div>
      {% endfor %}
    </div>

    <div class="card">
      <h2>Beginner-friendly Summary</h2>
      {% for label, s in beginner_summaries.items() %}
        <p><span class="pill">{{ label }}</span> {{ s }}</p>
      {% endfor %}
    </div>

    <div class="card">
      <h2>Interview-style Summaries</h2>
      <ul>
      {% for label, s in interview_summaries.items() %}
        <li><span class="pill">{{ label }}</span> {{ s }}</li>
      {% endfor %}
      </ul>
    </div>

    <div class="card">
      <h2>Runtime Benchmarks</h2>
      <div id="runtime">{{ runtime_div | safe }}</div>
      <h3>Table (mean ± 95% CI)</h3>
      <table>
        <thead>
          <tr>
            <th>n</th>
            {% for label, _ in manual_complexities.items() %}
              <th>{{ label }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in runtime_table %}
            <tr>
              <td class="mono">{{ row.n }}</td>
              {% for label, _ in manual_complexities.items() %}
                {% set c = row[label] %}
                <td class="mono">{{ c.mean | human_time }} ± {{ ((c.upper - c.lower)/2) | human_time }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Peak Memory (per call)</h2>
      <div id="memory">{{ memory_div | safe }}</div>
      <h3>Table (mean ± 95% CI)</h3>
      <table>
        <thead>
          <tr>
            <th>n</th>
            {% for label, _ in manual_complexities.items() %}
              <th>{{ label }}</th>
            {% endfor %}
          </tr>
        </thead>
        <tbody>
          {% for row in memory_table %}
            <tr>
              <td class="mono">{{ row.n }}</td>
              {% for label, _ in manual_complexities.items() %}
                {% set c = row[label] %}
                <td class="mono">{{ c.mean | human_bytes }} ± {{ ((c.upper - c.lower)/2) | human_bytes }}</td>
              {% endfor %}
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Comparison Summary</h2>
      <p class="muted">Best/worst runtime per n (lower is better). Mean ranks aggregate performance across all n.</p>
      <table>
        <thead>
          <tr>
            <th>n</th>
            <th>Best Runtime</th>
            <th>Worst Runtime</th>
            <th>Mean Ranks</th>
          </tr>
        </thead>
        <tbody>
          {% for row in comparison_rows %}
            <tr>
              <td class="mono">{{ row.n }}</td>
              <td>{{ row.best_runtime }}</td>
              <td>{{ row.worst_runtime }}</td>
              <td class="mono">
                {% for label, rankv in row.mean_ranks.items() %}
                  <span class="pill">{{ label }}: {{ "%.2f"|format(rankv) }}</span>
                {% endfor %}
              </td>
            </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>

    <div class="card">
      <h2>Methods</h2>
      <div class="code">{{ methods_text }}</div>
      <p class="footer">Report generated by <span class="mono">algoscope</span>.</p>
    </div>
  </div>
</body>
</html>
